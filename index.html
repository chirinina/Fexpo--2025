<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Preinscipciones-FEXPO 2025</title>
    <!-- Agrega el CSS de flatpickr -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <link
      rel="icon"
      type="image/png"
      href="https://www.esam.edu.bo/img/logo_esam_principal.png"
    />
    <!-- Agrega el script de flatpickr -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>

    <!-- Agrega el archivo de idioma español -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/es.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

    <link
      href="https://unpkg.com/@heroicons/react@1.0.6/24/solid.js"
      rel="stylesheet"
    />
    <style>
      .bg-yellow-gradient {
        background: linear-gradient(
          135deg,
          #fef08a 0%,
          #fde047 50%,
          #facc15 100%
        );
      }
    </style>
  </head>
  <body class="min-h-screen bg-gray-200 dark:bg-gray-900">
    <!-- Botón Admin -->
    <div class="fixed top-4 right-4 z-50">
      <!-- Botón Admin flotante - Versión profesional -->
      <div class="fixed top-5 right-5 z-50">
        <button
          onclick="togglePasswordPrompt()"
          class="group bg-indigo-600 dark:bg-teal-600 text-white px-5 py-3 rounded-full hover:bg-indigo-700 dark:hover:bg-teal-700 transition-all shadow-lg flex items-center gap-2 font-medium focus:outline-none focus:ring-4 focus:ring-indigo-300 dark:focus:ring-teal-300/50 ring-opacity-50"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-5 w-5 transition-transform group-hover:rotate-12"
            viewBox="0 0 20 20"
            fill="currentColor"
          >
            <path
              fill-rule="evenodd"
              d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z"
              clip-rule="evenodd"
            />
          </svg>
          <span class="hidden md:inline">Admin</span>
        </button>
      </div>

      <!-- Panel de contraseña - Diseño profesional avanzado -->
      <div
        id="passwordPrompt"
        class="hidden fixed top-24 right-6 bg-white dark:bg-gray-800 backdrop-blur-lg p-6 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 z-50 w-80 animate-fade-in"
      >
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-semibold text-gray-800 dark:text-gray-100">
            Acceso Administrativo
          </h2>
          <button
            onclick="togglePasswordPrompt()"
            class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"
          >
            <svg
              class="w-5 h-5"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>
        </div>

        <div class="space-y-4">
          <div>
            <label
              class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"
            >
              Contraseña
            </label>
            <div class="relative">
              <input
                id="adminPassword"
                type="password"
                class="w-full px-4 py-2.5 text-gray-800 dark:text-gray-200 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:focus:ring-teal-500 focus:border-transparent transition-all pr-10"
                placeholder="••••••••"
              />
              <button
                onclick="togglePasswordVisibility()"
                class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"
              >
                <svg
                  id="eyeIcon"
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                  ></path>
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                  ></path>
                </svg>
              </button>
            </div>
          </div>

          <button
            onclick="checkPassword()"
            class="w-full bg-indigo-600 dark:bg-teal-600 hover:bg-indigo-700 dark:hover:bg-teal-700 text-white py-2.5 px-4 rounded-lg font-medium transition-all focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:focus:ring-teal-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 shadow-sm"
          >
            Verificar Acceso
          </button>
        </div>

        <!-- Mensaje de estado mejorado -->
        <div
          id="passwordMessage"
          class="mt-4 p-3 rounded-lg text-sm font-medium text-center hidden"
        ></div>
      </div>

      <!-- Animación mejorada -->
      <style>
        @keyframes fade-in {
          0% {
            opacity: 0;
            transform: translateY(-10px) scale(0.98);
          }
          100% {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .animate-fade-in {
          animation: fade-in 0.25s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
      </style>

      <!-- Lógica JS mejorada -->
      <script>
        function togglePasswordPrompt() {
          const prompt = document.getElementById("passwordPrompt");
          prompt.classList.toggle("hidden");
          document.getElementById("passwordMessage").classList.add("hidden");
          document.getElementById("adminPassword").value = "";
          document.getElementById("adminPassword").type = "password";
          resetEyeIcon();
        }

        function togglePasswordVisibility() {
          const passwordInput = document.getElementById("adminPassword");
          const eyeIcon = document.getElementById("eyeIcon");

          if (passwordInput.type === "password") {
            passwordInput.type = "text";
            eyeIcon.innerHTML = `
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"></path>
        `;
          } else {
            passwordInput.type = "password";
            resetEyeIcon();
          }
        }

        function resetEyeIcon() {
          document.getElementById("eyeIcon").innerHTML = `
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
      `;
        }

        function checkPassword() {
          const inputPassword = document.getElementById("adminPassword").value;
          const message = document.getElementById("passwordMessage");
          const correctPassword = "admin123";

          message.classList.remove(
            "hidden",
            "bg-red-100",
            "text-red-700",
            "bg-green-100",
            "text-green-700",
            "dark:bg-red-900/30",
            "dark:text-red-300",
            "dark:bg-green-900/30",
            "dark:text-green-300"
          );

          if (inputPassword === correctPassword) {
            message.textContent = "Acceso autorizado. Redirigiendo...";
            message.classList.add(
              "bg-green-100",
              "text-green-700",
              "dark:bg-green-900/30",
              "dark:text-green-300"
            );

            setTimeout(() => {
              toggleAdminPanel(); // Tu función para mostrar el panel admin
              togglePasswordPrompt();
            }, 1000);
          } else {
            message.textContent =
              "Credenciales incorrectas. Intente nuevamente.";
            message.classList.add(
              "bg-red-100",
              "text-red-700",
              "dark:bg-red-900/30",
              "dark:text-red-300"
            );
          }
        }
      </script>
    </div>

    <!-- Contenedor principal con imagen -->
    <div class="container mx-auto px-4 py-12 flex flex-col md:flex-row gap-8">
      <!-- Imagen de presentación -->
      <div class="w-full md:w-1/3 lg:w-2/5 relative">
        <div class="sticky top-4 md:top-20 h-full">
          <!-- Contenedor de imagen principal con superposición -->
          <div class="relative">
            <!-- Imagen principal (misma en todos los dispositivos) -->
            <img
              src="/microcredenciales.jpg"
              alt="Estudiantes universitarios"
              class="w-full h-auto rounded-2xl shadow-xl object-cover max-h-[60vh] md:max-h-[80vh]"
            />

            <!-- Imagen pequeña superpuesta (más grande en desktop) -->
            <div
              class="absolute -top-3 -left-3 w-16 h-16 sm:w-20 sm:h-20 md:-top-8 md:-left-9 md:w-30 md:h-18 border-1 border-white rounded-lg shadow-xl overflow-hidden transform hover:scale-105 transition-transform duration-300"
            >
              <img
                src="https://blogposgrado.ucontinental.edu.pe/hs-fs/hubfs/Blogposts-%20Setiembre/maestria_gestion_gerencia_publica_555450025.jpg?width=750&height=422&name=maestria_gestion_gerencia_publica_555450025.jpg"
                alt="Logo Universidad Siglo XX"
                class="w-full h-full object-cover"
              />
            </div>
          </div>

          <!-- Texto (ajuste responsivo sin cambiar estilo) -->
          <div class="mt-4 md:mt-5 px-3 text-center overflow-hidden">
            <h3
              class="text-base sm:text-lg md:text-xl font-medium text-gray-800 dark:text-white animate-slide-in-left"
            >
              ¡Impulsa tu futuro con un certificado internacional!
            </h3>
            <p
              class="mt-2 sm:mt-3 text-xs sm:text-sm text-gray-600 dark:text-gray-300 max-w-2xl mx-auto animate-slide-in-right"
            >
              Aprovecha esta oportunidad única de profesionalizarte con aval
              europeo, gracias al respaldo de UPI Panamá. Inscríbete en la Fexpo
              Sucre y obtén tu diploma por un precio especial.
            </p>
          </div>

          <style>
            @keyframes slideInLeft {
              0% {
                opacity: 0;
                transform: translateX(-20px);
              }
              100% {
                opacity: 1;
                transform: translateX(0);
              }
            }
            @keyframes slideInRight {
              0% {
                opacity: 0;
                transform: translateX(20px);
              }
              100% {
                opacity: 1;
                transform: translateX(0);
              }
            }
            .animate-slide-in-left {
              animation: slideInLeft 0.5s ease-out forwards;
            }
            .animate-slide-in-right {
              animation: slideInRight 0.5s ease-out 0.2s forwards;
            }
          </style>
        </div>
      </div>

      <!-- Formulario de Registro -->
      <div id="registroForm" class="md:w-2/3 lg:w-3/5 py-8">
        <div
          class="bg-white dark:bg-gray-800 rounded-t-2xl shadow-xl p-8 w-full mx-auto border-t border-l border-r border-gray-200 dark:border-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-600"
          type="tel"
        >
          <div class="text-center mb-12 space-y-0">
            <!-- Título principal -->
            <div
              class="overflow-hidden h-[4.5rem] sm:h-[5rem] flex items-center justify-center"
            >
              <h1
                class="text-3xl sm:text-4xl font-normal tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-blue-900 via-blue-700 to-blue-900 dark:from-yellow-300 dark:via-yellow-200 dark:to-yellow-400 animate-[text-focus-in_1s_both]"
              >
                Certificación Internacional
              </h1>
            </div>

            <!-- Línea divisora ultra-fina -->
            <div class="w-full px-12 sm:px-24 overflow-hidden">
              <div
                class="h-[0.5px] bg-gradient-to-r from-transparent via-blue-300 dark:via-gray-500/60 to-transparent animate-[scale-in-hor-center_0.8s_0.4s_both]"
              ></div>
            </div>

            <!-- Subtítulo PROFESIONAL MEJORADO - MÁXIMA CLARIDAD -->
            <div
              class="overflow-hidden h-7 flex items-center justify-center mt-3"
            >
              <p
                class="text-[0.8rem] sm:text-[0.9rem] font-normal tracking-wide text-blue-900/95 dark:text-gray-800/95 animate-[fade-in_0.6s_0.8s_both] leading-snug"
              >
                <span
                  class="border-b border-blue-300/70 dark:border-gray-500/50 pb-[3px]"
                >
                  Registro de cursos de especialización
                </span>
              </p>
            </div>
          </div>

          <form id="formulario" class="space-y-4 sm:space-y-6 md:space-y-8">
            <!-- Tabs de Navegación - Super Responsivo -->
            <div
              class="flex overflow-x-auto scrollbar-hide pb-1 sm:pb-2 space-x-2 sm:space-x-4 border-b border-gray-200 dark:border-gray-700"
            >
              <button
                type="button"
                data-tab="personal"
                class="tab-button active shrink-0 px-3 py-2 sm:px-4 sm:py-2.5 md:px-6 md:py-3 text-xs sm:text-sm md:text-base text-blue-900 dark:text-gray-300 hover:text-blue-700 dark:hover:text-yellow-400 transition-all font-medium border-b-2 border-blue-600 dark:border-yellow-500"
              >
                Datos Personales
              </button>
              <button
                type="button"
                data-tab="academico"
                class="tab-button shrink-0 px-3 py-2 sm:px-4 sm:py-2.5 md:px-6 md:py-3 text-xs sm:text-sm md:text-base text-blue-900 dark:text-gray-300 hover:text-blue-700 dark:hover:text-yellow-400 transition-all font-medium"
              >
                Formación Académica
              </button>
              <button
                type="button"
                data-tab="contacto"
                class="tab-button shrink-0 px-3 py-2 sm:px-4 sm:py-2.5 md:px-6 md:py-3 text-xs sm:text-sm md:text-base text-blue-900 dark:text-gray-300 hover:text-blue-700 dark:hover:text-yellow-400 transition-all font-medium"
              >
                Contacto y Cursos
              </button>
            </div>

            <!-- Contenido de Tabs -->
            <div class="tab-content active" data-tab="personal">
              <div
                class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 md:gap-6"
              >
                <div class="space-y-4">
                  <!-- Nombres -->
                  <div>
                    <label
                      class="block text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                    >
                      Nombres <span class="text-red-500">*</span>
                    </label>

                    <input
                      type="text"
                      id="nombres"
                      required
                      class="w-full px-4 py-3 text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                      placeholder="Ingrese sus nombres"
                    />
                  </div>

                  <!-- Apellidos -->
                  <div>
                    <label
                      class="block text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                      >Apellidos <span class="text-red-500">*</span></label
                    >
                    <div class="flex gap-4">
                      <input
                        type="text"
                        id="apellido1"
                        required
                        class="w-full px-4 py-3 text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                        placeholder="Primer apellido"
                      />
                      <input
                        type="text"
                        id="apellido2"
                        class="w-full px-4 py-3 text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                        placeholder="Segundo apellido"
                      />
                    </div>
                  </div>

                  <!-- CI y Extensión abreviado -->
                  <div>
                    <label
                      class="block text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                      >Carnet de Identidad
                      <span class="text-red-500">*</span></label
                    >
                    <div class="flex gap-4">
                      <input
                        type="number"
                        id="documento"
                        class="w-full px-4 py-3 text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-0 focus:border-blue-600 dark:focus:border-yellow-500"
                        placeholder="N° CI"
                      />
                      <select
                        id="extension"
                        class="w-24 px-3 py-3 text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 focus:outline-none focus:ring-0 focus:border-blue-600 dark:focus:border-yellow-500"
                      >
                        <option value=""></option>
                        <option value="Tj">Tj</option>
                        <option value="Ch">Ch</option>
                        <option value="Pt">Pt</option>
                        <option value="Sc">Sc</option>
                        <option value="Be">Be</option>
                        <option value="Pa">Pa</option>
                        <option value="Lp">Lp</option>
                        <option value="Or">Or</option>
                        <option value="Cb">Cb</option>
                        <option value="Ext">Ext</option>
                      </select>
                    </div>
                  </div>

                  <!-- Género y Dirección -->
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label
                        class="block text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                        >Género <span class="text-red-500">*</span></label
                      >
                      <select
                        id="genero"
                        required
                        class="w-full px-4 py-3 text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                      >
                        <option value=""></option>
                        <option value="Masculino">Masculino</option>
                        <option value="Femenino">Femenino</option>
                      </select>
                    </div>
                  </div>
                </div>

                <div class="space-y-2 sm:space-y-3 md:space-y-4">
                  <div>
                    <label
                      class="block text-xs sm:text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                    >
                      Fecha Nacimiento <span class="text-red-500">*</span>
                    </label>
                    <input
                      type="text"
                      id="fechaNacimiento"
                      required
                      class="w-full px-3 py-2 sm:px-3 sm:py-2.5 md:px-4 md:py-3 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                      placeholder="Seleccionar fecha"
                    />
                  </div>

                  <script>
                    document.addEventListener("DOMContentLoaded", function () {
                      flatpickr("#fechaNacimiento", {
                        locale: "es",
                        dateFormat: "d/m/Y",
                        minDate: "01/01/1900",
                        maxDate: "today",
                        defaultDate: "01/01/1990",
                        allowInput: true,
                      });
                    });
                  </script>

                  <div>
                    <label
                      class="block text-xs sm:text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                      >Ubicación <span class="text-red-500">*</span></label
                    >
                    <div class="grid grid-cols-2 gap-2 sm:gap-3 md:gap-4">
                      <input
                        type="text"
                        id="departamento"
                        required
                        class="w-full px-3 py-2 sm:px-3 sm:py-2.5 md:px-4 md:py-3 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                        placeholder="Departamento"
                      />
                      <input
                        type="text"
                        id="ciudad"
                        required
                        class="w-full px-3 py-2 sm:px-3 sm:py-2.5 md:px-4 md:py-3 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                        placeholder="Ciudad"
                      />
                    </div>
                  </div>
                  <div>
                    <label
                      class="block text-xs sm:text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                      >Dirección <span class="text-red-500">*</span></label
                    >
                    <input
                      type="text"
                      id="direccion"
                      required
                      class="w-full px-3 py-2 sm:px-3 sm:py-2.5 md:px-4 md:py-3 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                      placeholder="Domicilio"
                    />
                  </div>
                </div>
              </div>
            </div>

            <!-- Sección Académica -->
            <div class="tab-content hidden" data-tab="academico">
              <div
                class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 md:gap-6"
              >
                <div class="space-y-2 sm:space-y-3 md:space-y-4">
                  <div>
                    <label
                      class="block text-xs sm:text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                      >Grado Académico
                      <span class="text-red-500">*</span></label
                    >
                    <select
                      id="grado"
                      required
                      class="w-full px-3 py-2 sm:px-3 sm:py-2.5 md:px-4 md:py-3 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                    >
                      <option value=""></option>
                      <option value="Licenciatura">Licenciatura</option>
                      <option value="Maestría">Maestría</option>
                      <option value="Doctorado">Doctorado</option>
                      <option value="Diplomado">Diplomado</option>
                      <option value="Otro">Otro</option>
                    </select>
                  </div>
                  <div>
                    <label
                      class="block text-xs sm:text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                      >Profesión <span class="text-red-500">*</span></label
                    >
                    <input
                      type="text"
                      id="profesion"
                      required
                      class="w-full px-3 py-2 sm:px-3 sm:py-2.5 md:px-4 md:py-3 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                      placeholder="Licenciado en Administración"
                    />
                  </div>
                </div>
                <div class="space-y-2 sm:space-y-3 md:space-y-4">
                  <div>
                    <label
                      class="block text-xs sm:text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                      >Institución de Egreso
                      <span class="text-red-500">*</span></label
                    >
                    <input
                      type="text"
                      id="institucion"
                      required
                      class="w-full px-3 py-2 sm:px-3 sm:py-2.5 md:px-4 md:py-3 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                      placeholder="Universidad Nacional de Siglo XX"
                    />
                  </div>
                  <div>
                    <label
                      class="block text-xs sm:text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                      >Año de Egreso</label
                    >
                    <input
                      type="number"
                      id="anoEgreso"
                      class="w-full px-3 py-2 sm:px-3 sm:py-2.5 md:px-4 md:py-3 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                      placeholder="2010"
                    />
                  </div>
                </div>
              </div>
            </div>

            <!-- Sección Contacto y Cursos -->
            <div class="tab-content hidden" data-tab="contacto">
              <div
                class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 md:gap-6"
              >
                <div class="space-y-2 sm:space-y-3 md:space-y-4">
                  <div>
                    <label
                      class="block text-xs sm:text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                      >Contacto <span class="text-red-500">*</span></label
                    >
                    <input
                      type="tel"
                      id="telefono"
                      required
                      class="w-full px-3 py-2 sm:px-3 sm:py-2.5 md:px-4 md:py-3 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent"
                      placeholder="Teléfono Móvil"
                    />
                    <input
                      type="email"
                      id="email"
                      required
                      class="w-full px-3 py-2 sm:px-3 sm:py-2.5 md:px-4 md:py-3 text-xs sm:text-sm bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-blue-900 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-transparent mt-2 sm:mt-3 md:mt-4"
                      placeholder="Correo Electrónico"
                    />
                  </div>
                </div>

                <div
                  class="space-y-2 sm:space-y-3 md:space-y-4 animate-fade-in"
                >
                  <label
                    class="block text-xs sm:text-sm font-medium text-blue-900 dark:text-gray-300 mb-1"
                  >
                    Selección de Cursos
                    <span class="text-red-500">*</span>
                  </label>

                  <div class="relative">
                    <select
                      id="cursos"
                      multiple
                      required
                      class="w-full px-3 py-2 sm:px-4 sm:py-3 text-xs sm:text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-blue-900 dark:text-gray-300 focus:outline-none focus:ring-1 focus:ring-blue-600 dark:focus:ring-yellow-500 focus:border-blue-600 dark:focus:border-yellow-500 h-28 sm:h-36 md:h-48 appearance-none"
                    >
                      <option value="Transformación Digital" class="py-1">
                        1. Transformación Digital
                      </option>
                      <option
                        value="Inicialización al Idioma Alemán"
                        class="py-1"
                      >
                        2. Inicialización al Idioma Alemán
                      </option>
                      <option
                        value="Gestión y Evaluación de Proyectos"
                        class="py-1"
                      >
                        3. Gestión y Evaluación de Proyectos
                      </option>
                      <option value="Ciencia de Datos con Python" class="py-1">
                        4. Ciencia de Datos con Python
                      </option>
                      <option value="Planificación Educativa" class="py-1">
                        5. Planificación Educativa
                      </option>
                      <option value="Educación Inclusiva" class="py-1">
                        6. Educación Inclusiva
                      </option>
                      <option value="Mercado de Valores" class="py-1">
                        7. Mercado de Valores
                      </option>
                      <option value="Data Analytics" class="py-1">
                        8. Data Analytics
                      </option>
                      <option value="Toxicología" class="py-1">
                        9. Toxicología
                      </option>
                      <option value="Terapias Nutricionales" class="py-1">
                        10. Terapias Nutricionales
                      </option>
                      <option value="Central de Esterilización" class="py-1">
                        11. Central de Esterilización
                      </option>
                      <option value="Investigación con IA" class="py-1">
                        12. Investigación con IA
                      </option>
                      <option value="Inmunonutrición" class="py-1">
                        13. Inmunonutrición
                      </option>
                      <option
                        value="Formación Basada en Competencias"
                        class="py-1"
                      >
                        14. Formación Basada en Competencias
                      </option>
                      <option value="Epidemiología" class="py-1">
                        16. Epidemiología
                      </option>
                      <option value="Lean Construction" class="py-1">
                        17. Lean Construction
                      </option>
                    </select>

                    <div
                      class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none"
                    >
                      <svg
                        class="h-4 w-4 text-gray-500 dark:text-gray-400"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M19 9l-7 7-7-7"
                        />
                      </svg>
                    </div>
                  </div>

                  <p
                    class="text-xxs sm:text-xs text-blue-800/70 dark:text-gray-400"
                  >
                    Selección múltiple: <br class="sm:hidden" />
                    • PC: Ctrl + clic <br class="sm:hidden" />
                    • Mac: ⌘ + clic <br />
                    • Móvil: Mantén presionado un item para seleccionar varios
                  </p>
                </div>
              </div>
            </div>

            <div
              class="flex justify-between pt-4 sm:pt-6 md:pt-8 border-t border-gray-200 dark:border-gray-700"
            >
              <!-- CONTENEDOR DE BOTONES -->
              <div
                class="flex flex-col sm:flex-row justify-between items-center w-full mt-6 gap-4"
              >
                <!-- BOTÓN ANTERIOR -->
                <button
                  type="button"
                  onclick="previousTab()"
                  class="group flex items-center gap-2 bg-blue-100 dark:bg-gray-700 text-blue-900 dark:text-gray-300 px-4 py-2 rounded-xl hover:bg-blue-200 dark:hover:bg-gray-600 transition-all duration-300 font-semibold text-sm shadow-sm border border-blue-200 dark:border-gray-600 animate-fade-slide-in"
                >
                  <!-- Ícono circular con flecha izquierda -->
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-5 h-5 group-hover:-translate-x-1 group-hover:scale-110 transition-transform duration-300"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <circle cx="12" cy="12" r="10" />
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M14 8l-4 4 4 4"
                    />
                  </svg>
                  <span>Anterior</span>
                </button>

                <!-- BOTÓN SIGUIENTE -->
                <button
                  type="button"
                  onclick="nextTab()"
                  class="group flex items-center gap-2 bg-blue-600 dark:bg-yellow-500 text-white dark:text-gray-900 px-4 py-2 rounded-xl hover:bg-blue-700 dark:hover:bg-yellow-600 transition-all duration-300 font-semibold text-sm shadow-sm border border-blue-500 dark:border-yellow-400 animate-fade-slide-in"
                >
                  <span>Siguiente</span>
                  <!-- Ícono doble flecha moderna -->
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-5 h-5 group-hover:translate-x-1 group-hover:scale-110 transition-transform duration-300"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M13 5l7 7-7 7M5 5l7 7-7 7"
                    />
                  </svg>
                </button>

                <!-- BOTÓN ENVIAR REGISTRO -->
                <button
                  type="submit"
                  class="group flex items-center justify-center gap-2 bg-blue-800 dark:bg-yellow-500 text-white dark:text-gray-900 px-5 py-2.5 rounded-xl hover:bg-blue-900 dark:hover:bg-yellow-600 transition-all duration-300 font-semibold text-sm shadow-md border border-blue-700 dark:border-yellow-400 animate-fade-scale-in"
                >
                  <!-- Ícono avión (enviar) -->
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-5 h-5 transition-transform duration-300 group-hover:-rotate-12 group-hover:translate-x-1"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M3 10l19-7-7 19-2.5-8.5L3 10z"
                    />
                  </svg>
                  <span>Registrar</span>
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Panel de Administración Premium -->
    <div
      id="adminPanel"
      class="hidden fixed inset-0 bg-gray-900/90 backdrop-blur-xl z-50 overflow-y-auto"
    >
      <div class="container mx-auto p-8 max-w-7xl">
        <div class="bg-white rounded-2xl shadow-xl border border-gray-200 p-8">
          <div class="flex justify-between items-center mb-8">
            <h2 class="text-3xl font-bold text-gray-800">
              Panel de Administración
            </h2>
            <button
              onclick="toggleAdminPanel()"
              class="text-gray-500 hover:text-gray-700 transition-all"
            >
              <svg
                class="w-8 h-8"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                />
              </svg>
            </button>
          </div>

          <div class="flex flex-wrap gap-4 mb-6">
            <input
              type="text"
              id="searchInput"
              placeholder="Buscar registros..."
              class="flex-1 px-4 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-800 placeholder-gray-400 focus:ring-2 focus:ring-yellow-500 focus:border-transparent"
            />
            <button
              onclick="exportToExcel()"
              class="bg-green-500 text-white px-6 py-2 rounded-lg hover:bg-green-600 flex items-center gap-2 font-medium"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                />
              </svg>
              Excel
            </button>
            <button
              onclick="exportToPDF()"
              class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 flex items-center gap-2 font-medium"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                />
              </svg>
              PDF
            </button>
          </div>

          <div class="overflow-x-auto rounded-xl border border-gray-200">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-700"
                  >
                    Nombres
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-700"
                  >
                    Documento
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-700"
                  >
                    Contacto
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-700"
                  >
                    Profesión
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-sm font-semibold text-gray-700"
                  >
                    Cursos
                  </th>
                  <th
                    class="px-6 py-4 text-left text-sm font-semibold text-gray-700"
                  >
                    Registro
                  </th>
                </tr>
              </thead>
              <tbody
                id="registrosTable"
                class="divide-y divide-gray-200 bg-white"
              >
                <!-- Datos dinámicos -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <!-- TOAST: Estilo + Contenedor + Función -->
    <style>
      @keyframes slide-in {
        0% {
          transform: translateX(100%);
          opacity: 0;
        }
        100% {
          transform: translateX(0);
          opacity: 1;
        }
      }
      .animate-slide-in {
        animation: slide-in 0.5s ease-out forwards;
      }
    </style>

    <!-- Contenedor de notificaciones -->
    <div id="toast-container" class="fixed top-5 right-5 z-50 space-y-2"></div>

    <script>
      function showToast(message, type = "success") {
        const toast = document.createElement("div");

        // Estilos base + color según tipo
        const baseClasses =
          "animate-slide-in px-4 py-2 rounded shadow-lg text-white font-semibold flex items-center gap-2";
        let bgColor = "bg-green-500";
        if (type === "error") bgColor = "bg-red-500";
        if (type === "info") bgColor = "bg-blue-500";

        toast.className = `${baseClasses} ${bgColor}`;
        toast.innerHTML = `
      <span>${message}</span>
      <button onclick="this.parentElement.remove()" class="ml-4 text-white hover:text-gray-200 text-sm">✖</button>
    `;

        document.getElementById("toast-container").appendChild(toast);

        // Eliminar automáticamente después de 3s
        setTimeout(() => {
          toast.remove();
        }, 3000);
      }
    </script>

    <script>
      // CACHE AGGRESIVO DE ELEMENTOS (solo una vez al inicio)
      const elements = {
        // Tabs y formulario
        tabs: document.querySelectorAll(".tab-content"),
        tabButtons: document.querySelectorAll(".tab-button"),
        form: document.getElementById("formulario"),

        // Botones de navegación
        prevBtn: document.querySelector('[onclick="previousTab()"]'),
        nextBtn: document.querySelector('[onclick="nextTab()"]'),
        submitBtn: document.querySelector('[type="submit"]'),

        // Panel admin
        registroForm: document.getElementById("registroForm"),
        adminPanel: document.getElementById("adminPanel"),
        registrosTable: document.getElementById("registrosTable"),
        searchInput: document.getElementById("searchInput"),

        // Inputs del formulario (cache dinámico)
        inputs: {},
      };

      // Llenar cache de inputs de forma optimizada
      document
        .querySelectorAll("#formulario input, #formulario select")
        .forEach((input) => {
          elements.inputs[input.id] = input;
        });

      // ESTADO OPTIMIZADO
      const state = {
        currentTab: 0,
        registros: JSON.parse(localStorage.getItem("registrosFexpo")) || [],
        searchCache: new Map(), // Cache para búsquedas
      };

      // OPTIMIZACIÓN DE RENDERIZADO
      const renderRow = (registro) => {
        const tr = document.createElement("tr");
        tr.className = "hover:bg-gray-50 transition-all";
        tr.innerHTML = `
            <td class="px-6 py-4 text-sm text-gray-800">${registro.nombres} ${
          registro.apellido1
        }</td>
            <td class="px-6 py-4 text-sm text-gray-800">${registro.documento} ${
          registro.extension
        }</td>
            <td class="px-6 py-4 text-sm text-gray-800">
              <div class="text-gray-700">${registro.telefono}</div>
              <div class="text-blue-500 text-xs">${registro.email}</div>
            </td>
            <td class="px-6 py-4 text-sm text-gray-800">${
              registro.profesion
            }</td>
            <td class="px-6 py-4 text-sm text-gray-800">
              <div class="flex flex-wrap gap-2 max-w-xs">
                ${registro.cursos
                  .map(
                    (curso) =>
                      `<span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">${curso}</span>`
                  )
                  .join("")}
              </div>
            </td>
            <td class="px-6 py-4 text-sm text-gray-500">${new Date(
              registro.timestamp
            ).toLocaleDateString()}</td>
          `;
        return tr;
      };

      // TAB SYSTEM ULTRA OPTIMIZADO
      const showTab = (n) => {
        // Usar classList con múltiples clases para mejor performance
        elements.tabs.forEach((tab, index) => {
          tab.classList.toggle("active", index === n);
          tab.classList.toggle("hidden", index !== n);
        });

        elements.tabButtons.forEach((btn, index) => {
          const active = index === n;
          btn.classList.toggle("active", active);
          btn.classList.toggle("text-yellow-700", active);
          btn.classList.toggle("border-yellow-500", active);
        });

        // Optimización: Solo actualizar lo necesario
        elements.prevBtn.classList.toggle("hidden", n === 0);
        elements.submitBtn.classList.toggle("hidden", n !== 2);
        elements.nextBtn.classList.toggle("hidden", n === 2);
      };

      // NAVEGACIÓN CON CACHE
      const nextTab = () => {
        if (state.currentTab < 2) {
          state.currentTab++;
          showTab(state.currentTab);
        }
      };

      const previousTab = () => {
        if (state.currentTab > 0) {
          state.currentTab--;
          showTab(state.currentTab);
        }
      };

      // FORM HANDLER OPTIMIZADO
      const handleSubmit = (e) => {
        e.preventDefault();

        // Obtener valores de forma optimizada usando cache
        const formData = {
          nombres: elements.inputs.nombres.value.trim(),
          apellido1: elements.inputs.apellido1.value.trim(),
          apellido2: elements.inputs.apellido2.value.trim(),
          documento: elements.inputs.documento.value.trim(),
          extension: elements.inputs.extension.value.trim(),
          genero: elements.inputs.genero.value,
          fechaNacimiento: elements.inputs.fechaNacimiento.value,
          departamento: elements.inputs.departamento.value.trim(),
          ciudad: elements.inputs.ciudad.value.trim(),
          direccion: elements.inputs.direccion.value.trim(),
          grado: elements.inputs.grado.value,
          profesion: elements.inputs.profesion.value.trim(),
          institucion: elements.inputs.institucion.value.trim(),
          telefono: elements.inputs.telefono.value.trim(),
          email: elements.inputs.email.value.trim(),
          cursos: Array.from(elements.inputs.cursos.selectedOptions).map(
            (o) => o.value
          ),
          timestamp: new Date().toISOString(),
        };

        // Validación optimizada
        const requiredFields = [
          { field: formData.nombres, name: "Nombres" },
          { field: formData.apellido1, name: "Primer Apellido" },
          { field: formData.documento, name: "Documento" },
          { field: formData.genero, name: "Género" },
          { field: formData.fechaNacimiento, name: "Fecha de Nacimiento" },
          { field: formData.departamento, name: "Departamento" },
          { field: formData.ciudad, name: "Ciudad" },
          { field: formData.direccion, name: "Dirección" },
          { field: formData.grado, name: "Grado Académico" },
          { field: formData.profesion, name: "Profesión" },
          { field: formData.institucion, name: "Institución" },
          { field: formData.telefono, name: "Teléfono" },
          { field: formData.email, name: "Email" },
          { field: formData.cursos.length, name: "Cursos" },
        ];

        const missingField = requiredFields.find((item) => !item.field);
        if (missingField) {
          showToast(`⚠️ Campo obligatorio faltante: ${missingField.name}`);
          return;
        }

        // Validar documento único con búsqueda optimizada
        const exists = state.registros.some(
          (r) => r.documento === formData.documento
        );
        if (exists) {
          showToast("⚠️ Este documento ya está registrado");
          return;
        }

        // Actualizar estado y storage de forma optimizada
        state.registros = [...state.registros, formData];
        localStorage.setItem("registrosFexpo", JSON.stringify(state.registros));

        showToast("Registro exitoso");
        elements.form.reset();
        showTab(0);
      };

      // ADMIN PANEL OPTIMIZADO
      const toggleAdminPanel = () => {
        elements.registroForm.classList.toggle("hidden");
        elements.adminPanel.classList.toggle("hidden");

        if (!elements.adminPanel.classList.contains("hidden")) {
          loadRegistros();
        }
      };

      // RENDERIZADO ULTRA RÁPIDO CON DOCUMENT FRAGMENT
      const loadRegistros = () => {
        const fragment = document.createDocumentFragment();

        // Usar for loop clásico para mejor performance con muchos registros
        for (let i = 0; i < state.registros.length; i++) {
          fragment.appendChild(renderRow(state.registros[i]));
        }

        // Limpiar y renderizar en una sola operación
        elements.registrosTable.innerHTML = "";
        elements.registrosTable.appendChild(fragment);
      };

      // BÚSQUEDA CON CACHE Y DEBOUNCE
      const handleSearch = (() => {
        let timeout;
        return (e) => {
          clearTimeout(timeout);
          timeout = setTimeout(() => {
            const term = e.target.value.toLowerCase();

            // Usar cache si está disponible
            if (state.searchCache.has(term)) {
              filterRows(state.searchCache.get(term));
              return;
            }

            const results = state.registros.filter((reg) =>
              JSON.stringify(reg).toLowerCase().includes(term)
            );

            // Actualizar cache
            state.searchCache.set(term, results);
            filterRows(results);
          }, 50);
        };
      })();

      // FILTRADO OPTIMIZADO
      const filterRows = (filteredData) => {
        const rows = elements.registrosTable.querySelectorAll("tr");
        const showAll = !filteredData;

        // Usar for loop clásico para mejor performance
        for (let i = 0; i < rows.length; i++) {
          const row = rows[i];
          row.style.display = showAll ? "" : "none";

          if (!showAll) {
            const registro = state.registros[i];
            if (filteredData.includes(registro)) {
              row.style.display = "";
            }
          }
        }
      };

      // EXPORTACIÓN RÁPIDA
      const exportToExcel = () => {
        const datosParaExcel = state.registros.map((registro) => ({
          ...registro,
          cursos: registro.cursos.join(", "),
        }));

        const ws = XLSX.utils.json_to_sheet(datosParaExcel);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Registros");
        XLSX.writeFile(wb, "registros_fexpo.xlsx");
      };

      const exportToPDF = () => {
        // Configuración del documento en horizontal (landscape) y tamaño oficio/legal
        const doc = new jspdf.jsPDF({
          orientation: "landscape",
          unit: "mm",
          format: "legal",
        });

        // Título del reporte
        doc.setFontSize(14);
        doc.setTextColor(40);
        doc.text(
          "REPORTE DE REGISTROS - FEXPO",
          doc.internal.pageSize.width / 2,
          15,
          { align: "center" }
        );

        // Generar la tabla con todos los campos requeridos
        doc.autoTable({
          startY: 20, // Espacio después del título
          head: [
            [
              "Nombres",
              "Primer Apellido",
              "Documento",
              "Género",
              "Fecha Nac.",
              "Departamento",
              "Ciudad",
              "Dirección",
              "Grado Académico",
              "Profesión",
              "Institución",
              "Teléfono",
              "Email",
              "Cursos",
            ],
          ],
          body: state.registros.map((r) => [
            r.nombres || "",
            r.apellido1 || "",
            `${r.documento || ""} ${r.extension || ""}`.trim(),
            r.genero || "",
            r.fechaNacimiento || "",
            r.departamento || "",
            r.ciudad || "",
            r.direccion || "",
            r.grado || "",
            r.profesion || "",
            r.institucion || "",
            r.telefono || "",
            r.email || "",
            r.cursos?.join(", ") || "",
          ]),
          theme: "grid",
          styles: {
            fontSize: 7, // Tamaño de fuente más pequeño para caber todo
            cellPadding: 1.5,
            overflow: "linebreak",
            minCellHeight: 5,
          },
          headStyles: {
            fillColor: [234, 179, 8], // Amarillo
            textColor: [0, 0, 0],
            fontStyle: "bold",
          },
          margin: { top: 20 },
          tableWidth: "auto", // Ajusta el ancho automáticamente
          columnStyles: {
            0: { cellWidth: "auto" }, // Nombres
            1: { cellWidth: "auto" }, // Apellido
            2: { cellWidth: 20 }, // Documento
            3: { cellWidth: 15 }, // Género
            4: { cellWidth: 20 }, // Fecha Nac.
            5: { cellWidth: "auto" }, // Departamento
            6: { cellWidth: "auto" }, // Ciudad
            7: { cellWidth: "auto" }, // Dirección
            8: { cellWidth: "auto" }, // Grado
            9: { cellWidth: "auto" }, // Profesión
            10: { cellWidth: "auto" }, // Institución
            11: { cellWidth: 20 }, // Teléfono
            12: { cellWidth: "auto" }, // Email
            13: { cellWidth: 30 }, // Cursos (más ancho)
          },
          pageBreak: "auto",
          overflow: "linebreak",
        });

        // Guardar el PDF
        doc.save("registros_fexpo.pdf");
      };

      // INICIALIZACIÓN RÁPIDA
      const init = () => {
        // Asignar eventos de forma optimizada
        elements.form.addEventListener("submit", handleSubmit);
        elements.searchInput.addEventListener("input", handleSearch);

        // Mostrar primera tab
        showTab(0);

        // Precargar datos si es necesario
        if (state.registros.length > 0) {
          requestIdleCallback(() => {
            loadRegistros();
          });
        }
      };

      // Iniciar cuando el DOM esté listo
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", init);
      } else {
        init();
      }
    </script>
  </body>
</html>
<style>
  /* SISTEMA DE ANIMACIONES PROFESIONAL */
  .tab-content {
    opacity: 0;
    transform: translateY(20px);
    animation: tabEntrance 0.8s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;
  }

  /* ANIMACIONES POR CAPAS (STAGGERED) */
  .form-field {
    opacity: 0;
    perspective: 1000px;
  }

  /* IZQUIERDA (odd items) */
  .form-field:nth-child(odd) {
    transform: translateX(-50px) rotateY(15deg);
    animation: slideFromLeft 0.7s cubic-bezier(0.175, 0.885, 0.32, 1.275)
      forwards;
  }

  /* DERECHA (even items) */
  .form-field:nth-child(even) {
    transform: translateX(50px) rotateY(-15deg);
    animation: slideFromRight 0.7s cubic-bezier(0.175, 0.885, 0.32, 1.275)
      forwards;
  }

  /* TIMING PERFECTO CON DELAYS ESCALONADOS */
  .form-field:nth-child(1) {
    animation-delay: 0.3s;
  }
  .form-field:nth-child(2) {
    animation-delay: 0.4s;
  }
  .form-field:nth-child(3) {
    animation-delay: 0.5s;
  }
  .form-field:nth-child(4) {
    animation-delay: 0.6s;
  }
  .form-field:nth-child(5) {
    animation-delay: 0.7s;
  }
  .form-field:nth-child(6) {
    animation-delay: 0.8s;
  }
  .form-field:nth-child(7) {
    animation-delay: 0.9s;
  }
  .form-field:nth-child(8) {
    animation-delay: 1s;
  }

  /* KEYFRAMES CINEMATOGRÁFICOS */
  @keyframes tabEntrance {
    0% {
      opacity: 0;
      transform: translateY(20px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideFromLeft {
    0% {
      opacity: 0;
      transform: translateX(-50px) rotateY(15deg);
      filter: blur(2px);
    }
    100% {
      opacity: 1;
      transform: translateX(0) rotateY(0);
      filter: blur(0);
    }
  }

  @keyframes slideFromRight {
    0% {
      opacity: 0;
      transform: translateX(50px) rotateY(-15deg);
      filter: blur(2px);
    }
    100% {
      opacity: 1;
      transform: translateX(0) rotateY(0);
      filter: blur(0);
    }
  }

  /* ANIMACIÓN ESPECIAL PARA EL SELECTOR DE CURSOS */
  .cursos-container {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
    animation: cursosEntrance 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275)
        forwards,
      cursosFloat 4s ease-in-out infinite;
    animation-delay: 1.1s;
  }

  @keyframes cursosEntrance {
    0% {
      opacity: 0;
      transform: translateY(30px) scale(0.95);
    }
    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  @keyframes cursosFloat {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-5px);
    }
  }

  /* BOTONES CON ANIMACIÓN DE MATERIAL DESIGN */
  .btn-container {
    opacity: 0;
    animation: fadeInUp 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    animation-delay: 1.3s;
  }

  @keyframes fadeInUp {
    0% {
      opacity: 0;
      transform: translateY(20px);
    }
    100% {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* EFECTO HOVER AVANZADO PARA CAMPOS */
  .form-field input:not(:focus),
  .form-field select:not(:focus) {
    transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
  }

  .form-field:hover input:not(:focus),
  .form-field:hover select:not(:focus) {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.1);
  }
</style>
